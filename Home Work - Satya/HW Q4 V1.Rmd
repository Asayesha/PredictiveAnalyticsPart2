
Reading the file

```{r }
rm(list = ls())
setwd("D:/Summer Semester/Intro to Predictive Modelling/Unsupervised/data")
filename = 'social_marketing.csv'
raw_data = read.csv(filename, header = TRUE)
rownames(raw_data) <- raw_data$X
raw_data = raw_data[,-c(1)]
summary(raw_data)
```


Getting chatter and uncategorized into one group as they are proxies for each other.
Getting spam and adult into one group as they both are most likely from bots.

```{r }
raw_data$nocat = raw_data$chatter + raw_data$uncategorized
raw_data$bots = raw_data$spam + raw_data$adult

raw_data = raw_data[,-c(1,5,35,36)]

```

Scaling the data

```{r }
scaled_data = raw_data[,-c(1)]
scaled_data = scale(scaled_data)

```

Calculating the mean and standard deviation for the columns

```{r}
mu = attr(scaled_data,"scaled:center")
sigma = attr(scaled_data,"scaled:scale")


```



Trying "elbow method" to get the best value for k. Tot.withinss gives the total within cluster sum of squares

```{r}

set.seed(21)
k.max = 20
data = scaled_data
wss = sapply(1:k.max, function(k){kmeans(data,k,nstart = 50,iter.max = 20)$tot.withinss})
plot(1:k.max, wss)
wss

```


Here we are trying to initialize using kmeans++ and the withinss is the same for both kmeans and kmeans++. Hence we are just going to take k means

```{r}
library(LICORS)  # for kmeans++
k.max = 20
data = scaled_data
wss = sapply(1:k.max, function(k){kmeanspp(data, k, nstart=25)$tot.withinss})
plot(1:k.max, wss)
wss
```




from the elbow chart we saw that k=9 is the good option to consider. Getting the clusters for k = 9

```{r}

cluster_cnt = 9
clust1 = kmeans(scaled_data, cluster_cnt, nstart=50,iter.max = 20)
clust1$center

i = 1

for (i  in (1:cluster_cnt)){
  cat (length(which(clust1$cluster == i)),"\n")
}



```


## Understanding cluster 1

The centroid of cluster 1 have high z-value for online gaming, college uni and sports playing

We can infer from these factors as these are most probably " university students"

```{r}
qplot(online_gaming, college_uni, data=raw_data, color=factor(clust1$cluster))


```


## Understanding cluster 2

The centroid of cluster 2 have high z-value for sports fandom, food, family, nutrition, religion,parenting and school

We can infer from these factors that this cluster is most probably "parents with kids who go to school"


```{r}
qplot(sports_fandom, parenting, data=raw_data, color=factor(clust1$cluster))


```


## Understanding cluster 3

The centroid of cluster 3 have high z-value for health nutrition, outdoors, personal fitness and have moderately high score for food and eco 

We can infer from these factors that this cluster is "fitness enthusiasts" who love working out


```{r}
qplot(health_nutrition, personal_fitness, data=raw_data, color=factor(clust1$cluster))


```


## Understanding cluster 4

The centroid of cluster 4 have negative z-value between -0.25 and -0.5 for almost all factors. And this cluster has close to 42% of the entire population. This is the cluster where all the "uncategorized people" fall under


## Understanding cluster 5

The centroid of cluster 5 have high z-value for tv film, music, art and have moderately high score for crafts, home and garden and small businesses

We can infer from these factors that this cluster is people who are into different kinds of "arts and crafts"

```{r}
qplot(tv_film, art, data=raw_data, color=factor(clust1$cluster))


```


## Understanding cluster 6

The centroid of cluster 6 have high scores in photo sharing, cooking, beauty, fashion and have moderatley high scores in music and shopping

We can infer from these factors that this cluster is for "younger women"

```{r}
qplot(beauty, fashion, data=raw_data, color=factor(clust1$cluster))


```


## Understanding cluster 7

The centroid of cluster 7 have high scores in travel, politics, news, computers and have moderately high scores in business and small business

We can infer from these factors that this cluster is for "business professionals" who are updated with what's currently happeing in the world

```{r}
qplot(travel, politics, data=raw_data, color=factor(clust1$cluster))


```


## Understanding cluster 8

The centroid of cluster 8 have high scores in sports fandom, politics, news, automotives and have moderately high scores in outdoors and family

We can infer from these factors that this cluster is with "middle aged men" without school going kids


```{r}
qplot(news, automotive, data=raw_data, color=factor(clust1$cluster))


```

## Understanding cluster 9

The centroid of cluster 9 have high scores for photo sharing, shopping, no category and have moderately high scores for eco, business, dating and small business

We can infer from these factors that this cluster is from "middle aged women who are active on the internet" and tweet about a lot of different things




